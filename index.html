<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco Quiz Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
        
        :root {
            --primary-green: #2E7D32; /* Forest green - more natural */
            --light-green: #A5D6A7;   /* Soft leaf green */
            --dark-green: #1B5E20;    /* Deep forest green */
            --accent-brown: #795548;  /* Earth brown */
            --natural-yellow: #FDD835; /* Sunlight yellow */
            --sky-blue: #4FC3F7;      /* Fresh sky blue */
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #87CEEB; /* Sky blue */
            perspective: 1000px;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Nature Animation Scene */
        .nature-scene {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
            z-index: -1;
        }
        
        /* Sky gradient */
        .sky {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #87CEEB 0%, #e0f7fa 100%);
        }
        
        /* Sun */
        .sun {
            position: absolute;
            top: 10%;
            right: 15%;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #FDD835 30%, rgba(255,235,59,0.3) 70%);
            border-radius: 50%;
            box-shadow: 0 0 50px rgba(255, 235, 59, 0.8);
            animation: sun-glow 5s infinite alternate;
        }
        
        @keyframes sun-glow {
            0% { box-shadow: 0 0 40px rgba(255, 235, 59, 0.5); transform: scale(1); }
            100% { box-shadow: 0 0 60px rgba(255, 235, 59, 0.7); transform: scale(1.02); }
        }
        
        /* Clouds */
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.9;
            box-shadow: 0 8px 5px rgba(0, 0, 0, 0.1);
        }
        
        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 50%;
        }
        
        .cloud-1 {
            top: 15%;
            left: -15%; /* Start further off screen */
            width: 120px;
            height: 60px;
            animation: float-cloud 70s cubic-bezier(0.4, 0, 0.6, 1) infinite; /* Slower, smoother */
            animation-delay: -5s; /* Stagger start */
        }
        
        .cloud-1::before {
            width: 60px;
            height: 60px;
            top: -30px;
            left: 15px;
        }
        
        .cloud-1::after {
            width: 80px;
            height: 80px;
            top: -25px;
            right: 15px;
        }
        
        .cloud-2 {
            top: 25%;
            left: -20%; /* Start further off screen */
            width: 160px;
            height: 70px;
            animation: float-cloud 85s cubic-bezier(0.4, 0, 0.6, 1) infinite; /* Slower, smoother */
            animation-delay: -15s; /* Stagger start */
        }
        
        .cloud-2::before {
            width: 70px;
            height: 70px;
            top: -30px;
            left: 20px;
        }
        
        .cloud-2::after {
            width: 100px;
            height: 100px;
            top: -40px;
            right: 25px;
        }
        
        .cloud-3 {
            top: 10%;
            left: -10%; /* Start further off screen */
            width: 100px;
            height: 50px;
            animation: float-cloud 60s cubic-bezier(0.4, 0, 0.6, 1) infinite; /* Slower, smoother */
        }
        
        .cloud-3::before {
            width: 50px;
            height: 50px;
            top: -20px;
            left: 10px;
        }
        
        .cloud-3::after {
            width: 70px;
            height: 70px;
            top: -25px;
            right: 10px;
        }
        
        /* Rename animation for clarity */
        @keyframes float-cloud {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(100vw + 300px)); } /* Ensure they clear the screen */
        }
        
        /* Birds */
        .bird {
            position: absolute;
            height: 2px;
            background-color: transparent;
        }
        
        .bird::before,
        .bird::after {
            content: '';
            position: absolute;
            height: 8px;
            width: 20px;
            top: -4px;
            background-color: #333;
            border-radius: 50% 50% 0 0;
            animation: flap-wings 0.8s infinite alternate;
        }
        
        .bird::before {
            left: -8px;
            transform-origin: right center;
        }
        
        .bird::after {
            left: 8px;
            transform-origin: left center;
        }
        
        @keyframes flap-wings {
            0% { transform: rotateZ(-5deg); }
            100% { transform: rotateZ(25deg); }
        }
        
        .bird-1 {
            top: 20%;
            left: -50px;
            width: 30px;
            animation: fly-bird 22s linear infinite; /* Slightly adjusted durations */
            animation-delay: -2s;
        }
        
        .bird-2 {
            top: 15%;
            left: -70px;
            width: 25px;
            animation: fly-bird 28s linear infinite;
            animation-delay: -8s;
        }
        
        .bird-3 {
            top: 12%;
            left: -40px;
            width: 20px;
            animation: fly-bird 19s linear infinite;
        }
        
        .bird-4 {
            top: 18%;
            left: -60px;
            width: 28px;
            animation: fly-bird 25s linear infinite;
            animation-delay: -5s;
        }
        
        .bird-5 {
            top: 25%;
            left: -80px;
            width: 22px;
            animation: fly-bird 30s linear infinite;
            animation-delay: -12s;
        }
        
        /* Updated bird flight path with vertical variation */
        @keyframes fly-bird {
            0% { transform: translateX(0) translateY(0) scale(0.9); opacity: 0.8; }
            25% { transform: translateX(calc(25vw + 50px)) translateY(-20px) scale(1); opacity: 1; }
            50% { transform: translateX(calc(50vw + 100px)) translateY(-30px) scale(1.1); opacity: 1; }
            75% { transform: translateX(calc(75vw + 150px)) translateY(-10px) scale(1); opacity: 1; }
            100% { transform: translateX(calc(100vw + 200px)) translateY(0) scale(0.9); opacity: 0.8; }
        }
        
        /* Rolling hills - Adjusted colors for depth */
        .hills {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40%;
            z-index: 0;
        }
        
        .hill-1 { /* Closest */
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 25%;
            background-color: #8BC34A;
            border-radius: 50% 50% 0 0 / 100% 100% 0 0;
            transform: scaleX(1.5) translateY(20%);
        }
        
        .hill-2 { /* Middle */
            position: absolute;
            bottom: 0;
            left: -50%;
            width: 80%;
            height: 30%;
            background-color: #7CB342; /* Slightly lighter/different shade */
            border-radius: 50% 50% 0 0 / 100% 100% 0 0;
            transform: scaleX(2) translateY(10%);
        }
        
        .hill-3 { /* Farthest */
            position: absolute;
            bottom: 0;
            right: -20%;
            width: 70%;
            height: 20%;
            background-color: #689F38; /* Slightly darker/muted */
            border-radius: 50% 50% 0 0 / 100% 100% 0 0;
            transform: scaleX(2);
        }
        
        /* Trees */
        .tree {
            position: absolute;
            bottom: 24%;
            z-index: 1;
            transform-origin: bottom center; /* Set origin for sway */
            animation: tree-sway 10s ease-in-out infinite alternate; /* Add sway */
        }
        
        .tree-trunk {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 30px;
            background-color: #795548;
            border-radius: 2px;
        }
        
        .tree-top {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-bottom: 60px solid #2E7D32;
            z-index: 2;
        }
        
        .tree-top-2 {
            position: absolute;
            bottom: 45px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 50px solid #388E3C;
            z-index: 1;
        }
        
        .tree-top-3 {
            position: absolute;
            bottom: 65px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 40px solid #43A047;
            z-index: 0;
        }
        
        /* Stagger tree sway */
        .tree-1 { left: 10%; transform: scale(0.7); animation-delay: -1s; }
        .tree-2 { left: 20%; transform: scale(0.9); animation-delay: -0.5s; }
        .tree-3 { left: 35%; transform: scale(0.6); animation-delay: -1.5s; }
        .tree-4 { left: 75%; transform: scale(0.8); animation-delay: -0.2s; }
        .tree-5 { left: 85%; transform: scale(0.7); animation-delay: -1.2s; }
        
        @keyframes tree-sway {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(1.5deg); } /* Very subtle sway */
        }
        
        /* Card styles */
        .card-3d {
            transform-style: preserve-3d;
            transition: all 0.5s ease;
            box-shadow: 0 10px 20px rgba(27, 94, 32, 0.15);
            background-color: rgba(255, 255, 255, 0.95);
            border: 1px solid #E8F5E9;
            z-index: 10;
            position: relative;
        }
        
        .card-3d:hover {
            transform: rotateY(3deg) rotateX(3deg);
        }
        
        .eco-button {
            background-color: var(--primary-green);
            color: white;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .eco-button:hover {
            background-color: var(--dark-green);
        }
        
        .eco-button:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background-image: url('data:image/svg+xml;charset=utf8,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" opacity="0.1"%3E%3Cpath fill="%23ffffff" d="M30,30 C40,20 60,20 70,30 C80,40 80,60 70,70 C60,80 40,80 30,70 C20,60 20,40 30,30 z"%3E%3C/path%3E%3C/svg%3E');
            background-size: 120px;
            pointer-events: none;
            z-index: 1;
        }
        
        .eco-input {
            border-color: var(--light-green);
            transition: all 0.3s ease;
        }
        
        .eco-input:focus {
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.2);
        }
        
        .option-card {
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            border: 1px solid #E8F5E9;
            overflow: hidden;
            position: relative;
        }
        
        .option-card::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background-image: url('data:image/svg+xml;charset=utf8,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50" height="50" opacity="0.05"%3E%3Cpath fill="%232E7D32" d="M25,0 A25,25 0 1,1 25,50 A25,25 0 1,1 25,0 z"%3E%3C/path%3E%3C/svg%3E');
            background-size: 80px;
            pointer-events: none;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(27, 94, 32, 0.1);
            border-color: var(--light-green);
        }
        
        .option-card:hover::before {
            opacity: 1;
        }
        
        .correct {
            animation: correctAnswer 0.5s ease;
            background-color: #C8E6C9 !important;
            border-color: #81C784 !important;
        }
        
        .correct::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 30px;
            height: 30px;
            background-color: #66BB6A;
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }
        
        .incorrect {
            animation: incorrectAnswer 0.5s ease;
            background-color: #FFCDD2 !important;
            border-color: #E57373 !important;
        }
        
        @keyframes correctAnswer {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes incorrectAnswer {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        
        .leaf-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }
        
        .progress-leaf {
            transition: all 0.5s ease;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
        }
        
        .reward-badge {
            animation: badgePop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        @keyframes badgePop {
            0% { transform: scale(0); }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .earth-spin {
            animation: spin 20s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Option button styles */
        .option-btn {
            transition: all 0.3s ease;
            position: relative;
        }
        
        .option-btn:hover {
            background-color: #E8F5E9;
        }
        
        .option-btn:disabled {
            cursor: not-allowed;
        }
        
        .correct-answer {
            background-color: #C8E6C9 !important;
            border-color: #81C784 !important;
            color: #2E7D32 !important;
        }
        
        .correct-answer::after {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #2E7D32;
        }
        
        .incorrect-answer {
            background-color: #FFCDD2 !important;
            border-color: #E57373 !important;
            color: #C62828 !important;
            opacity: 0.7;
        }
        
        .incorrect-answer::after {
            content: '\f00d';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #C62828;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <!-- Animated Nature Scene -->
    <div class="nature-scene">
        <div class="sky"></div>
        <div class="sun"></div>
        
        <!-- Clouds -->
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>
        <div class="cloud cloud-3"></div>
        
        <!-- Birds -->
        <div class="bird bird-1"></div>
        <div class="bird bird-2"></div>
        <div class="bird bird-3"></div>
        <div class="bird bird-4"></div>
        <div class="bird bird-5"></div>
        
        <!-- Hills and Trees -->
        <div class="hills">
            <div class="hill-1"></div>
            <div class="hill-2"></div>
            <div class="hill-3"></div>
        </div>
        
        <div class="tree tree-1">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
            <div class="tree-top-2"></div>
            <div class="tree-top-3"></div>
        </div>
        
        <div class="tree tree-2">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
            <div class="tree-top-2"></div>
            <div class="tree-top-3"></div>
        </div>
        
        <div class="tree tree-3">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
            <div class="tree-top-2"></div>
            <div class="tree-top-3"></div>
        </div>
        
        <div class="tree tree-4">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
            <div class="tree-top-2"></div>
            <div class="tree-top-3"></div>
        </div>
        
        <div class="tree tree-5">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
            <div class="tree-top-2"></div>
            <div class="tree-top-3"></div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="click-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-simple-countdown-922.mp3" type="audio/mpeg">
    </audio>
    <audio id="correct-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>
    <audio id="wrong-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" type="audio/mpeg">
    </audio>
    <audio id="complete-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3" type="audio/mpeg">
    </audio>
    
    <div class="w-full max-w-2xl">
        <!-- App Header -->
        <header class="text-center mb-8">
            <div class="relative inline-block">
                <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center">
                    <i class="fas fa-leaf text-4xl text-green-600 leaf-animation"></i>
                </div>
                <div class="absolute -bottom-2 -right-2 bg-green-100 rounded-full w-8 h-8 flex items-center justify-center">
                    <i class="fas fa-recycle text-sm text-green-600 earth-spin"></i>
                </div>
            </div>
            <h1 class="text-3xl font-bold text-green-800 mt-4">Eco Quiz Challenge</h1>
            <p class="text-green-600">Test your sustainability knowledge!</p>
        </header>
        
        <!-- Main Quiz Container -->
        <div id="quiz-container" class="bg-white rounded-2xl overflow-hidden shadow-xl card-3d">
            <!-- Progress Bar -->
            <div class="bg-green-100 h-3 relative">
                <div id="progress-fill" class="bg-green-500 h-full transition-all duration-500 ease-out" style="width: 0%"></div>
            </div>
            
            <!-- Quiz Content -->
            <div class="p-6 md:p-8">
                <!-- Sound Toggle Button -->
                <div class="absolute top-4 right-4">
                    <button id="toggle-sound" class="text-green-600 hover:text-green-800 transition-colors">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </div>
                
                <!-- Intro Section -->
                <div id="intro-section" class="text-center">
                    <div class="mb-6">
                        <img src="Earth_icon_2.png" alt="Earth" class="w-32 h-32 mx-auto earth-spin">
                    </div>
                    <h2 class="text-2xl font-bold text-green-800 mb-4">Welcome to the Sustainability Quiz!</h2>
                    <p class="text-gray-600 mb-6">Test your knowledge about environmental protection, renewable energy, and sustainable living practices.</p>
                    
                    <p class="text-sm text-green-700 mb-4">We'll randomly select 10 questions from our database for you to answer.</p>
                    
                    <button id="start-quiz" class="eco-button py-3 px-6 rounded-full transition-all transform hover:scale-105 shadow-lg" disabled>
                        Start Quiz <i class="fas fa-seedling ml-2"></i>
                    </button>
                </div>
                
                <!-- Quiz Section -->
                <div id="quiz-section" class="hidden">
                    <h2 id="question" class="text-xl font-bold text-green-800 mb-4"></h2>
                    
                    <div id="options-container" class="space-y-3">
                        <!-- Options will be added dynamically -->
                    </div>
                    
                    <!-- Fact Box -->
                    <div id="fact-box" class="mt-6 p-4 bg-green-50 rounded-lg border border-green-100 hidden">
                        <p class="text-sm italic text-green-800">
                            <i class="fas fa-info-circle mr-2"></i>
                            <span id="fact-text"></span>
                        </p>
                    </div>
                    
                    <!-- Next Button -->
                    <div class="mt-6 text-center">
                        <button id="next-btn" class="eco-button py-2 px-6 rounded-full transition-all transform hover:scale-105 hidden">
                            Next Question <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div id="results-section" class="hidden text-center">
                    <div class="mb-6">
                        <div class="w-24 h-24 rounded-full bg-green-100 mx-auto flex items-center justify-center">
                            <i class="fas fa-trophy text-4xl text-green-600"></i>
                        </div>
                    </div>
                    
                    <h2 class="text-2xl font-bold text-green-800 mb-3">Quiz Completed!</h2>
                    <p id="score" class="text-xl text-green-700 mb-6"></p>
                    
                    <!-- Save Score -->
                    <div id="save-score-form" class="bg-green-50 rounded-lg p-4 mb-6 border border-green-100">
                        <h3 class="font-bold text-green-800 mb-3">Save Your Score</h3>
                        <div class="flex flex-col gap-3">
                            <input 
                                type="text" 
                                id="name-input"
                                class="w-full px-4 py-2 border eco-input rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" 
                                placeholder="Enter your name"
                            >
                            <button 
                                id="save-score" 
                                disabled
                                class="eco-button py-2 px-4 rounded-md transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                Save Score <i class="fas fa-save ml-2"></i>
                            </button>
                        </div>
                    </div>
                    <!-- Score Saved Success Message -->
                    <div id="score-saved-message" class="bg-green-100 rounded-lg p-4 mb-6 border border-green-200 hidden">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-600 text-xl mr-3"></i>
                            <div>
                                <h3 class="font-bold text-green-800">Score Saved Successfully!</h3>
                                <p class="text-green-700 text-sm">Your score has been added to the leaderboard</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Leaderboard -->
                    <div class="mt-6">
                        <h3 class="font-bold text-green-800 mb-3">Leaderboard</h3>
                        <div id="leaderboard-list" class="bg-white p-4 rounded-lg border border-green-100">
                            <!-- Leaderboard will be populated dynamically -->
                        </div>
                        <!-- Pagination Controls -->
                        <div id="leaderboard-pagination" class="flex justify-between items-center mt-3 text-sm">
                            <button id="prev-page" class="text-green-700 hover:text-green-900 disabled:opacity-50 disabled:cursor-not-allowed px-2 py-1">
                                <i class="fas fa-chevron-left mr-1"></i> Previous
                        </button>
                            <div>
                                Page <span id="current-page">1</span> of <span id="total-pages">1</span>
                            </div>
                            <button id="next-page" class="text-green-700 hover:text-green-900 disabled:opacity-50 disabled:cursor-not-allowed px-2 py-1">
                                Next <i class="fas fa-chevron-right ml-1"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Restart Button -->
                    <div class="mt-6">
                        <button 
                            onclick="location.reload()" 
                            class="text-green-700 hover:text-green-900 transition-colors"
                        >
                            Take Quiz Again <i class="fas fa-redo ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Eco Facts Footer -->
        <footer class="text-center mt-8 text-sm text-gray-600">
            <div class="mb-2">
                <i class="fas fa-seedling text-green-500 mr-1"></i>
                <i class="fas fa-tint text-blue-400 mx-1"></i>
                <i class="fas fa-sun text-yellow-500 mx-1"></i>
                <i class="fas fa-wind text-gray-400 ml-1"></i>
            </div>
            <p>Every correct answer plants a virtual seed for a greener future <i class="fas fa-leaf text-green-500"></i></p>
            <p class="mt-2">
                <a href="admin.html" class="text-green-600 hover:text-green-800 text-xs">
                    <i class="fas fa-chart-bar mr-1"></i> View Statistics
                </a>
            </p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Audio elements
            const clickSound = document.getElementById('click-sound');
            const correctSound = document.getElementById('correct-sound');
            const wrongSound = document.getElementById('wrong-sound');
            const completeSound = document.getElementById('complete-sound');
            
            // Sound volume control
            let soundEnabled = true;
            const toggleSoundBtn = document.getElementById('toggle-sound');
            toggleSoundBtn.addEventListener('click', function() {
                soundEnabled = !soundEnabled;
                toggleSoundBtn.innerHTML = soundEnabled ? 
                    '<i class="fas fa-volume-up"></i>' : 
                    '<i class="fas fa-volume-mute"></i>';
                
                // Play a sound to confirm the change
                if (soundEnabled) {
                    clickSound.play();
                }
            });
            
            // Helper function to play sounds
            function playSound(sound) {
                if (soundEnabled) {
                    sound.currentTime = 0;
                    sound.play();
                }
            }
            
            // Quiz variables
            const startQuizBtn = document.getElementById('start-quiz');
            const introSection = document.getElementById('intro-section');
            const quizSection = document.getElementById('quiz-section');
            const resultsSection = document.getElementById('results-section');
            const questionElement = document.getElementById('question');
            const optionsContainer = document.getElementById('options-container');
            const progressFill = document.getElementById('progress-fill');
            const factBox = document.getElementById('fact-box');
            const factText = document.getElementById('fact-text');
            const nextBtn = document.getElementById('next-btn');
            const scoreElement = document.getElementById('score');
            const nameInput = document.getElementById('name-input');
            const saveScoreBtn = document.getElementById('save-score');
            const saveScoreForm = document.getElementById('save-score-form');
            const scoreSavedMessage = document.getElementById('score-saved-message');
            const leaderboardList = document.getElementById('leaderboard-list');
            
            let allQuestions = [];
            let currentQuestions = []; // Selected 10 questions for the current quiz
            let currentQuestionIndex = 0;
            let score = 0;
            let quizCompleted = false;

            // Shuffle function to randomize questions
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
            
            // Fetch all questions
            fetch('questions.json')
                .then(response => response.json())
                .then(data => {
                    allQuestions = data;
                    startQuizBtn.disabled = false;
                })
                .catch(error => {
                    console.error('Error loading questions:', error);
                    alert('Failed to load questions. Please refresh the page.');
                });
            
            // Start quiz
            startQuizBtn.addEventListener('click', function() {
                playSound(clickSound);
                
                // Shuffle all questions and select only 10
                const shuffledQuestions = shuffleArray([...allQuestions]);
                currentQuestions = shuffledQuestions.slice(0, 10);
                
                introSection.classList.add('hidden');
                quizSection.classList.remove('hidden');
                loadQuestion();
            });
            
            // Load question
            function loadQuestion() {
                const currentQuestion = currentQuestions[currentQuestionIndex];
                questionElement.textContent = currentQuestion.question;
                
                optionsContainer.innerHTML = '';
                currentQuestion.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.classList.add('option-btn', 'eco-button', 'w-full', 'p-3', 'mt-3', 'rounded-lg', 'text-left');
                    button.addEventListener('click', () => selectOption(index));
                    optionsContainer.appendChild(button);
                });
                
                // Update progress bar
                const progressPercentage = (currentQuestionIndex / currentQuestions.length) * 100;
                progressFill.style.width = `${progressPercentage}%`;
                
                factBox.classList.add('hidden');
                nextBtn.classList.add('hidden');
            }
            
            // Select option
            function selectOption(selectedIndex) {
                const currentQuestion = currentQuestions[currentQuestionIndex];
                const optionButtons = optionsContainer.querySelectorAll('.option-btn');
                
                // Disable all options
                optionButtons.forEach(button => {
                    button.disabled = true;
                });
                
                // Style correct and incorrect options
                optionButtons.forEach((button, index) => {
                    if (index === currentQuestion.answer) {
                        button.classList.add('correct-answer');
                    } else {
                        button.classList.add('incorrect-answer');
                    }
                });
                
                // Check if answer is correct
                if (selectedIndex === currentQuestion.answer) {
                    playSound(correctSound);
                    score++;
                } else {
                    playSound(wrongSound);
                }
                
                // Show fact
                factText.textContent = currentQuestion.fact;
                factBox.classList.remove('hidden');
                
                // Show next button
                nextBtn.classList.remove('hidden');
            }

            // Next question
            nextBtn.addEventListener('click', function() {
                playSound(clickSound);
                
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    currentQuestionIndex++;
                    loadQuestion();
                } else {
                    showResults();
                }
            });
            
            // Show results
            function showResults() {
                playSound(completeSound);
                quizSection.classList.add('hidden');
                resultsSection.classList.remove('hidden');
                
                // Calculate percentage
                const percentage = Math.round((score / currentQuestions.length) * 100);
                scoreElement.textContent = `You scored ${score} out of ${currentQuestions.length} (${percentage}%)`;
                
                quizCompleted = true;
                
                // Display leaderboard
                displayLeaderboard();
            }
            
            // Save score
            saveScoreBtn.addEventListener('click', function() {
                playSound(clickSound);
                
                if (!nameInput.value.trim() || !quizCompleted) {
                    return;
                }
                
                const userData = {
                    name: nameInput.value.trim(),
                    score: score,
                    total: currentQuestions.length,
                    percentage: Math.round((score / currentQuestions.length) * 100),
                    date: new Date().toISOString()
                };
                
                // Get existing data
                let quizData = JSON.parse(localStorage.getItem('quizData')) || {};
                
                // Initialize participants array if it doesn't exist
                if (!quizData.participants) {
                    quizData.participants = [];
                }
                
                // Add new participant
                quizData.participants.push(userData);
                
                // Save back to localStorage
                localStorage.setItem('quizData', JSON.stringify(quizData));
                
                // Hide form and show success message
                saveScoreForm.classList.add('hidden');
                scoreSavedMessage.classList.remove('hidden');
                
                // Update displayed leaderboard
                displayLeaderboard();
            });
            
            // Enable/disable save button based on input
            nameInput.addEventListener('input', function() {
                saveScoreBtn.disabled = !nameInput.value.trim() || !quizCompleted;
            });
            
            // Display leaderboard
            function displayLeaderboard() {
                // Get data from localStorage
                const quizData = JSON.parse(localStorage.getItem('quizData')) || {};
                const participants = quizData.participants || [];
                
                // Sort by score (highest first)
                const sortedParticipants = [...participants].sort((a, b) => b.percentage - a.percentage);
                
                // Pagination variables
                const entriesPerPage = 5;
                let currentPage = 1;
                const totalPages = Math.max(1, Math.ceil(sortedParticipants.length / entriesPerPage));
                
                // Update page indicators
                document.getElementById('current-page').textContent = currentPage;
                document.getElementById('total-pages').textContent = totalPages;
                
                // Pagination controls
                const prevPageBtn = document.getElementById('prev-page');
                const nextPageBtn = document.getElementById('next-page');
                
                // Initial button state
                prevPageBtn.disabled = currentPage === 1;
                nextPageBtn.disabled = currentPage === totalPages || sortedParticipants.length === 0;
                
                // Pagination event listeners
                prevPageBtn.addEventListener('click', function() {
                    if (currentPage > 1) {
                        currentPage--;
                        renderLeaderboardPage(sortedParticipants, currentPage, entriesPerPage);
                        updatePaginationControls();
                    }
                });
                
                nextPageBtn.addEventListener('click', function() {
                    if (currentPage < totalPages) {
                        currentPage++;
                        renderLeaderboardPage(sortedParticipants, currentPage, entriesPerPage);
                        updatePaginationControls();
                    }
                });
                
                // Helper function to update pagination controls
                function updatePaginationControls() {
                    document.getElementById('current-page').textContent = currentPage;
                    prevPageBtn.disabled = currentPage === 1;
                    nextPageBtn.disabled = currentPage === totalPages;
                }
                
                // Initial render of page 1
                renderLeaderboardPage(sortedParticipants, currentPage, entriesPerPage);
            }
            
            // Render a specific page of the leaderboard
            function renderLeaderboardPage(sortedParticipants, page, entriesPerPage) {
                // Calculate slice for current page
                const startIndex = (page - 1) * entriesPerPage;
                const endIndex = startIndex + entriesPerPage;
                const currentPageEntries = sortedParticipants.slice(startIndex, endIndex);
                
                // Clear current leaderboard
                leaderboardList.innerHTML = '';
                
                // Add headers
                const headerRow = document.createElement('div');
                headerRow.classList.add('grid', 'grid-cols-3', 'gap-2', 'font-bold', 'mb-2');
                headerRow.innerHTML = `
                    <div>Rank</div>
                    <div>Name</div>
                    <div>Score</div>
                `;
                leaderboardList.appendChild(headerRow);
                
                // If no participants
                if (sortedParticipants.length === 0) {
                    const emptyRow = document.createElement('div');
                    emptyRow.textContent = 'No scores saved yet. Be the first!';
                    emptyRow.classList.add('my-2', 'text-center', 'col-span-3');
                    leaderboardList.appendChild(emptyRow);
                    return;
                }
                
                // Add current page entries
                currentPageEntries.forEach((participant, index) => {
                    const row = document.createElement('div');
                    row.classList.add('grid', 'grid-cols-3', 'gap-2', 'my-1');
                    
                    // Calculate actual rank based on page number
                    const actualRank = startIndex + index + 1;
                    
                    // Highlight the current user
                    const isCurrentUser = quizCompleted && 
                        participant.name === nameInput.value.trim() && 
                        participant.score === score && 
                        participant.date === sortedParticipants.find(p => 
                            p.name === nameInput.value.trim() && 
                            p.score === score
                        )?.date;
                    
                    if (isCurrentUser) {
                        row.classList.add('font-bold', 'text-green-700');
                    }
                    
                    row.innerHTML = `
                        <div>${actualRank}</div>
                        <div>${participant.name}</div>
                        <div>${participant.percentage}%</div>
                    `;
                    leaderboardList.appendChild(row);
                });
            }
        });
    </script>
</body>
</html>